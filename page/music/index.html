<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>ğŸŒ´ç´¯äº†å—ï¼Œå¬ä¸€ä¼šéŸ³ä¹å§</title><link rel="stylesheet" href="css/index.css"></head><body><div class="wrap"><div class="play_wrap" id="player"><div class="search_bar"><h4 class="music_title">Music</h4><input type="text" autocomplete="off" v-model="query" @keyup.enter="searchMusic();"></div><div class="center_con"><div class="song_wrapper" ref="song_wrapper"><ul class="song_list"><li v-for="item in musicList"><a href="javascript:;" @click="playMusic(item.id)"></a> <b>{{item.name}}</b><span><i @click="playMv(item.mvid)" v-if="item.mvid!=0"></i></span></li></ul><img src="images/line.png" class="switch_btn" alt=""></div><div class="player_con" :class="{playing:isPlay}"><img src="images/player_bar.png" class="play_bar"> <img src="images/disc.png" class="disc autoRotate"> <img :src="coverUrl==''?'./images/cover.png':coverUrl" class="cover autoRotate"></div><div class="comment_wrapper" ref="comment_wrapper"><h5 class="title">çƒ­é—¨ç•™è¨€</h5><div class="comment_list"><dl v-for="item in hotComments"><dt><img :src="item.user.avatarUrl" alt=""></dt><dd class="name">{{item.user.nickname}}</dd><dd class="detail">{{item.content}}</dd></dl></div><img src="images/line.png" class="right_line"></div></div><div class="audio_con"><audio ref="audio" @play="play" @pause="pause" :src="musicUrl" controls autoplay loop class="myaudio"></audio></div><div class="video_con" v-show="showVideo"><video ref="video" :src="mvUrl" controls></video><div class="mask" @click="closeMv"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script><script src="https://unpkg.com/axios/dist/axios.min.js"></script><script>// è®¾ç½®axiosçš„åŸºåœ°å€
    axios.defaults.baseURL = 'https://autumnfish.cn';



    // å®ä¾‹åŒ–vue
    var app = new Vue({
      el: "#player",
      data: {
        // æœç´¢å…³é”®å­—
        query: '',
        // æ­Œæ›²åˆ—è¡¨
        musicList: [],
        // æ­Œæ›²url
        musicUrl: '',
        // æ˜¯å¦æ­£åœ¨æ’­æ”¾
        isPlay: false,
        // æ­Œæ›²çƒ­é—¨è¯„è®º
        hotComments: [],
        // æ­Œæ›²å°é¢åœ°å€
        coverUrl: '',
        // æ˜¾ç¤ºè§†é¢‘æ’­æ”¾
        showVideo: false,
        // mvåœ°å€
        mvUrl: ''
      },
      // æ–¹æ³•
      methods: {
        // æœç´¢æ­Œæ›²
        searchMusic() {
          if (this.query == 0) {
            return
          }
          axios.get('/search?keywords=' + this.query).then(response => {
            // ä¿å­˜å†…å®¹
            this.musicList = response.data.result.songs;

          })

          // æ¸…ç©ºæœç´¢
          this.query = ''
        },
        // æ’­æ”¾æ­Œæ›²
        playMusic(musicId) {
          // è·å–æ­Œæ›²url
          axios.get('/song/url?id=' + musicId).then(response => {
            // ä¿å­˜æ­Œæ›²urlåœ°å€
            this.musicUrl = response.data.data[0].url
          })
          // è·å–æ­Œæ›²çƒ­é—¨è¯„è®º
          axios.get('/comment/hot?type=0&id=' + musicId).then(response => {
            // console.log(response)
            // ä¿å­˜çƒ­é—¨è¯„è®º
            this.hotComments = response.data.hotComments

          })
          // è·å–æ­Œæ›²å°é¢
          axios.get('/song/detail?ids=' + musicId).then(response => {
            // console.log(response)
            // è®¾ç½®å°é¢
            this.coverUrl = response.data.songs[0].al.picUrl
          })

        },
        // audioçš„playäº‹ä»¶
        play() {
          this.isPlay = true
          // æ¸…ç©ºmvçš„ä¿¡æ¯
          this.mvUrl = ''
        },
        // audioçš„pauseäº‹ä»¶
        pause() {
          this.isPlay = false
        },
        // æ’­æ”¾mv
        playMv(vid) {
          if (vid) {
            this.showVideo = true;
            // è·å–mvä¿¡æ¯
            axios.get('/mv/url?id=' + vid).then(response => {
              // console.log(response)
              // æš‚åœæ­Œæ›²æ’­æ”¾
              this.$refs.audio.pause()
              // è·å–mvåœ°å€
              this.mvUrl = response.data.data.url
            })
          }
        },
        // å…³é—­mvç•Œé¢
        closeMv() {
          this.showVideo = false
          this.$refs.video.pause()
        },
        // æœç´¢å†å²è®°å½•ä¸­çš„æ­Œæ›²
        historySearch(history) {
          this.query = history
          this.searchMusic()
          this.showHistory = false;
        }
      },

    })</script></body></html>